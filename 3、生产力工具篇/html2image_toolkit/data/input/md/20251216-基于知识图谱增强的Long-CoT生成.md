# 基于知识图谱增强的Long-CoT生成

论文名称：Knowledge-Augmented Long-CoT Generation for Complex Biomolecular Reasoning

地址：https://arxiv.org/pdf/2511.08024

知识图谱增强的Long-CoT生成：生物分子推理创新框架
├── 1. 核心问题与动机
│   ├── 问题：大模型直接用于生物分子推理
│   │   ├── 易产生生物不合理输出
│   │   └── 逻辑推理链不一致
│   └── 解决方案：用知识图谱(KG)引导推理，合成高质量训练数据
│
├── 2. 整体四步合成流程
│   ├── a) 数据监管与实体提取
│   │   └── 从问题(Q)和正确答案(A)中提取关键实体
│   ├── b) 推理路径检索（核心：路径采样）
│   │   ├── 将实体映射至KG结点
│   │   └── 基于预定义模板检索推理路径 P(Q,A;d)
│   ├── c) 思维链轨迹构建（双重创新）
│   │   ├── 初始CoT生成：基于路径P引导大模型生成推理链C
│   │   └── CoT剪枝：通过提示工程删除冗余，保留核心逻辑链C_pruned
│   └── d) 训练与优化
│       ├── 监督微调(SFT)：使用(Q, A, C_pruned)三元组
│       └── 强化学习(GRPO)：奖励函数 = 格式分(1) + 答案正确性分(5)
│
├── 3. 关键创新点一：推理路径设计
│   ├── 3.1 三种基本结构模式
│   │   ├── 线性链结构：实体通过单一顺序关系链连接
│   │   ├── 发散结构：从同一实体衍生出多条推理轨迹
│   │   └── 收敛结构：不同关系分支终止于一个共同实体
│   └── 3.2 任务难度分层（基于路径复杂度d）
│       ├── 基础 (d≤5)：适应症、生物过程等简单推理
│       ├── 中等 (6≤d≤7)：超说明书用药、副作用等
│       └── 困难 (d≥8)：禁忌症、药物相互作用等复杂推理
│
├── 4. 关键创新点二：思维链优化策略
│   ├── 初始CoT生成：利用路径中的语义关系锚定KG事实
│   └── CoT剪枝：通过专门提示构造器，确保推理链的清晰度与准确率
│
├── 5. 实验与效果
│   ├── 基础模型：Qwen3-4B/8B
│   ├── 对比基准：基础模型、蒸馏CoT模型
│   └── 核心结果：效果显著优于基准，尤其在复杂推理任务上
│
└── 6. 核心价值总结
    ├── 方法论：提供“KG路径采样 → CoT合成 → 模型优化”的完整框架
    ├── 质量：通过结构化设计和剪枝，生成高质量、逻辑严密的训练数据
    └── 可扩展性：路径设计和难度分层方法可迁移至其他领域复杂推理

知识图谱用于大模型推理数据合成，核心还是看看怎么设计这个路径采样。

其实方式很简单，**实体提取，路径采样，然后蒸馏cot，筛选cot，再微调，强化**。

## 一、知识图谱合成COT数据用于复杂生物分子推理

基于知识图谱作数据合成的思路。

主要讲的故事是**复杂生物分子（如蛋白质相互作用、信号级联）推理问题**，打的点是大模型直接应用于生物分子推理时，易生成生物不合理输出（如错误的药物代谢路径）和逻辑不一致的推理链，**所以可以通过知识图谱引导推理**。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeAEIibYy5xF8xmgrIjgW70UPSRM1ia4AJskHiakRETrMSe6cE9iabE8YcYw/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=0)

先说结论，效果优于基础模型和蒸馏CoT模型，这个很自然，核心是**用知识图谱作多知识去噪与知识关联**。看点是其路径的设计和难度的设计。

**1、 整体框架**

![图片](https://mmbiz.qpic.cn/sz_mmbiz_jpg/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdewEZicibyH4AZvZYJiaTQyPuKfCicEnShK7XlvS1hwk04rz2YR4mzpGECbQ/640?wx_fmt=jpeg&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=1)

**a)数据监管**【给定生物分子问题与候选答案，从问题（EQ）和正确答案（EA）中提取实体】；

**b)推理路径检索**【将提取的实体映射至知识图谱结点，随后通过预定义模板获取推理路径P(Q,A;d)】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeThLW4jK9eZlpnXl8xPLbDProzjpj38GuBK2CobViaLoxHJDAI6qwOxA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=2)

**c)思维链轨迹构建**【推导出的路径p提供语义关系以引导初始思维链生成。生成的轨迹经过剪枝阶段进一步优化，确保清晰度与准确率】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHde7DKGcILGibicFXyspbzxFH0BQGspKAplO1LeicuMhGcFuKpu1vJQ18Qpw/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=3)

**d)训练**【经处理的(Q,A,Cpruned)数据对用于监督微调（SFT），随后通过强化学习（GRPO）对齐模型的推理与答案生成过程】；

**2、看推理路径的设计**

这里的设计有2层。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeWmcK0d23zqupcmMZicWMyL1BEiaianFFUiaMCibOUwB30jXkSiaPnXrqRPUg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=4)

一种是**三种基本结构模式**的定义，覆盖不同推理复杂度。包括线性链结构【其中实体通过单一的顺序关系链连接】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeWTl9Wwofd8F4vFV9RkqIB9LRaQRAvL3cCmyLYbdiaHVADUoYTicAaNlQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=5)

+发散结构【从同一实体出发衍生出多条推理轨迹】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeaMiamqNsNN78RibxZEvohWbcVY2icO5X5KY4MFRB2XTPCjVJ4QnHjuAvA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=6)

+收敛结构【不同的关系分支终止于一个共同实体】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdezzib0RmMLV7V458sBIU6NzTK4PRnlhickMTzn2AdLqcbLvh0CicG1LA0g/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=7)

一种是**任务难度的定义**，基于路径复杂度d（链深度+分支广度）分层，量化推理难度。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdelo7rf05Z1K0nzL7V4fqBgr71icwPROMbNJQrrIwiaQ1X02pbeHhicudyg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=8)

包括：**基础（Basic**）【d≤5，适应症、生物过程，如“Fluvastatin可治疗哪种疾病？”】、**中等（Medium**）【6≤d≤7，超说明书用药、副作用，如“Flurbiprofen的已知副作用是什么？”】、**困难（Hard**）【d≥8，禁忌症、药物相互作用，如“Nitrogen的禁忌症是哪种疾病？”】；

**3、看初始CoT生成和CoT剪枝**

两个部分，一个管造，一个管筛选。

**CoT生成**上，【基于检索到的推理路径，定义提示构建器Φ，整合问题Q、正确答案A以及推理路径P，生成锚定KG事实的初始推理链C】

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeC4IfSVGeo9OmEhqBSEB9a7YnTbZAEhFicUnw3OA7icFuMyJQzClWBGeQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=9)

**CoT剪枝**上，【通过剪枝提示构造器Ψ，以问题Q和初始推理链C作为输入，指导大模型通过删除不必要的推理步骤，仅保留通向答案的核心逻辑链Cpruned】；

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdeiaDBw6I1aiaia8PzRlp9BGibibzGfGJsl0Osp0PxISeP1ABRIhXkb8tdvdw/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=10)

**4、看监督微调与强化训练**

**微调**阶段，使用（Qwen3-4B与Qwen3-8B）以遵循知识图谱引导模板，生成连贯的多步推理；

**强化学习**阶段，基于GRPO，奖励函数为Rreward=Rformat+Ranswer，答案正确性可获得5的主要奖励，而格式符合性则提供1的额外奖励。

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/fUBU1yiaEmJggXhc5pBb3saVH6rgPqHdez8Eic5o2w1CFN2T1icSKNuYRUhkQwiaicAn53P3CgZmC2iattWTcqxfZm3w/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=11)
